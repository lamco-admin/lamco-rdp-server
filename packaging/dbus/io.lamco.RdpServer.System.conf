<!DOCTYPE busconfig PUBLIC
 "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<!--
  D-Bus System Bus Policy for Lamco RDP Server

  This policy allows the lamco-rdp user to own the service name
  and allows authenticated users to interact with it via polkit.

  Installation:
    sudo cp io.lamco.RdpServer.System.conf /etc/dbus-1/system.d/
-->
<busconfig>
  <!-- Only the dedicated service user can own the name -->
  <policy user="lamco-rdp">
    <allow own="io.lamco.RdpServer.System"/>
  </policy>

  <!-- Root can also own it (for debugging) -->
  <policy user="root">
    <allow own="io.lamco.RdpServer.System"/>
    <allow send_destination="io.lamco.RdpServer.System"/>
    <allow receive_sender="io.lamco.RdpServer.System"/>
  </policy>

  <!-- Any user can send messages (polkit will handle authorization) -->
  <policy context="default">
    <allow send_destination="io.lamco.RdpServer.System"/>
    <allow receive_sender="io.lamco.RdpServer.System"/>
  </policy>
</busconfig>
