version: 1

AppDir:
  path: ./AppDir

  app_info:
    id: io.lamco.rdp-server
    name: lamco-rdp-server
    icon: io.lamco.rdp-server
    version: !ENV ${VERSION}
    exec: usr/bin/lamco-rdp-server-gui
    exec_args: $@

  apt:
    arch: amd64
    sources:
      - sourceline: 'deb http://archive.ubuntu.com/ubuntu/ noble main restricted universe multiverse'
      - sourceline: 'deb http://archive.ubuntu.com/ubuntu/ noble-updates main restricted universe multiverse'

    include:
      # Core libraries
      - libc6
      - libgcc-s1
      - libstdc++6
      - libssl3t64
      # PipeWire
      - libpipewire-0.3-0t64
      - libspa-0.2-modules
      # Wayland
      - libwayland-client0
      # Portal/D-Bus
      - libdbus-1-3
      # PAM
      - libpam0g
      # FUSE
      - libfuse3-3
      # XKB
      - libxkbcommon0
      # GTK4/Adwaita for GUI
      - libgtk-4-1
      - libadwaita-1-0

  files:
    exclude:
      - usr/share/man
      - usr/share/doc
      - usr/share/lintian
      - usr/share/icons/hicolor/icon-theme.cache
      - usr/lib/x86_64-linux-gnu/gconv
      - usr/share/locale

  runtime:
    env:
      APPDIR_LIBRARY_PATH: '$APPDIR/usr/lib/x86_64-linux-gnu:$APPDIR/lib/x86_64-linux-gnu'

  test:
    fedora:
      image: appimagecrafters/tests-env:fedora-latest
      command: ./AppRun --help
    debian:
      image: appimagecrafters/tests-env:debian-stable
      command: ./AppRun --help
    arch:
      image: appimagecrafters/tests-env:archlinux-latest
      command: ./AppRun --help

AppImage:
  update-information: 'gh-releases-zsync|lamco-admin|lamco-rdp-server|latest|lamco-rdp-server-*x86_64.AppImage.zsync'
  sign-key: None
  arch: x86_64
